```sheet
|  ▷▶▷▶ Query 실행 순서 ▷▶▷▶  | < | < | < | < | < | < | < | < | < |
| :----: | :------: | :---------------: | :------: | :------------: | :------: | :---------------: | :------: | :------------: | :------------: |
|  [With](1.%20With)  |   [From](2.%20From%20&%20Join)   |       [Where](3.%20Where%20&%20Group%20By%20&%20Having#^where)       | [Group by](3.%20Where%20&%20Group%20By%20&%20Having#^groupby) |     [Having](3.%20Where%20&%20Group%20By%20&%20Having#^having)     | [Select](4.%20Select) | [Distinct](연산자#^distinct) | [Union / Union all](연산자#^union) | [Order by](5.%20Order%20By%20&%20Offset%20&%20Limit#^orderby) | [Offset](5.%20Order%20By%20&%20Offset%20&%20Limit#^offset) / [Limit](5.%20Order%20By%20&%20Offset%20&%20Limit#^limit) |
```
 - LAG , LEAD
	 - Column 값을 그대로 가져오되 행의 위치 조절이 가능
	 - LAG : 행을 한 줄 밑으로 내림
	 - LEAD : 행을 한 줄 위로 올림
		 - 기본 한 줄 Up, Down 방식이지만 Column 뒤에 정수를 추가하여 원하는 만큼 위치 조절 가능
		 - `LAG(e.employeenumber,2) over(order by e.employeenumber)` => 두 줄 밑으로 내림
			 - ![[Pasted image 20251224162004.png]]
	 - Partition By 를 사용하여 파티션 처리된 Column의 출력 처리를 조정하는 것도 가능
		 - ![[Pasted image 20251224162011.png]]
		 - https://for-my-wealthy-life.tistory.com/48
 - First_value , Last_value
	 - Partition By 로 그룹화하고 Order By 로 정렬된 데이터 중 첫 번째/마지막 값을 반환
	 - First_value
		 - 윈도우 프레임 기본값 (처음 ~ 현재) 내에서 항상 첫 번째 값을 가져오므로 별도 옵션 없이 ORDER BY 만으로 잘 동작함.
	 - Last_value
		 - 기본적으로 "현재 행까지의 범위" 만 조회하므로, 기대와 달리 "현재 값" 이 나올 수 있음.
		 - 그룹 전체의 진짜 마지막 값을 구하려면 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING (범위: 처음부터 끝까지) 옵션을 반드시 추가해야 함.
		 - ![[Pasted image 20251224162145.png]]